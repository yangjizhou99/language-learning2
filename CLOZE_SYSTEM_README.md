# Cloze 挖空练习系统

## 系统概述

这是一个基于 AI 的 Cloze 挖空练习系统，支持多语言（英语、日语、中文），按难度分级，具有智能评分功能。

## 功能特点

### 1. AI 生成题目
- 支持英语、日语、中文三种语言
- 5个难度等级（L1-L5）
- 可指定主题或使用通用主题
- 自动生成文章和挖空位置
- 提供标准答案、可接受答案和干扰项

### 2. 管理员审核系统
- 可视化编辑界面
- 可修改题目内容、答案和解释
- 支持添加/删除可接受答案
- 草稿保存和发布功能

### 3. 智能评分系统
- AI 容错评分（0/0.5/1分制）
- 支持同义词和近义表达
- 详细的评分理由和改进建议
- 整体表现分析

## 使用流程

### 管理员操作

1. **生成题目**
   - 访问 `/admin/cloze/ai`
   - 选择语言、难度、题目数量
   - 可选填写主题
   - 点击"生成题目"

2. **审核编辑**
   - 在生成界面中编辑题目内容
   - 修改标题、文章内容
   - 调整空白答案和可接受答案
   - 添加或修改解释说明

3. **保存发布**
   - 点击"保存草稿"保存编辑
   - 点击"发布题目"将题目加入正式题库

### 学员练习

1. **选择设置**
   - 访问 `/practice/cloze`
   - 选择语言和难度等级
   - 点击"开始练习"

2. **答题**
   - 在文章中的空白处填入答案
   - 点击"提交答案"进行评分

3. **查看结果**
   - 查看总分和整体反馈
   - 了解每个空白的详细评分
   - 获得改进建议

## 数据库结构

### cloze_drafts（草稿表）
- 存储管理员生成的题目草稿
- 支持编辑和审核流程
- 记录 AI 生成信息

### cloze_items（正式题库）
- 存储已审核发布的题目
- 供学员练习使用
- 包含完整的题目信息

### cloze_attempts（作答记录）
- 记录学员的答题情况
- 存储 AI 评分结果
- 支持学习进度跟踪

## API 接口

### 管理员接口
- `POST /api/admin/cloze/generate` - 生成题目草稿
- `POST /api/admin/cloze/save` - 保存草稿
- `POST /api/admin/cloze/publish` - 发布题目

### 学员接口
- `GET /api/cloze/next` - 获取下一题
- `POST /api/cloze/score` - 提交答案评分

## 部署说明

1. **运行数据库迁移**
   ```bash
   # 确保 Supabase 项目已配置
   # 运行迁移文件：20250120000005_create_cloze_tables.sql
   ```

2. **配置环境变量**
   - 确保 AI 服务配置正确
   - 数据库连接正常

3. **测试功能**
   - 管理员生成题目
   - 学员练习功能
   - AI 评分准确性

## 技术特点

- **容错评分**：支持同义词、近义词、形态变化
- **多语言支持**：针对不同语言的特点优化
- **难度分级**：根据语言水平提供合适难度的题目
- **智能反馈**：提供详细的学习建议和改进方向

## 注意事项

1. 首次使用需要管理员生成一些题目
2. AI 评分结果仅供参考，重要考试建议人工复核
3. 建议定期审核和更新题库内容
4. 可以根据用户反馈调整评分标准
